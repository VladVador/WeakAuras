--- WeakAura Strings ---
dqv5RaGisjpcvfvxcvL(ePqYOevoLOQvrcvVcvfzwcv3IiTle(fPGggj5yiLSmsP6zOQW0ibCnKc2MeP(gsrzCifY5eIsRdPiVtinpsO09qf7dPuhePOYcrkQYdjbnrsPCrsrBKi6JsKyKcLojPqTss1ljfszMsKu3Kui2PqKFIuOgkjuSuuvvpvIAQKORku0wfIIVskKQXIuuvNfvfL3kuO5krsCxHOAVeL)ssny4WOSysipgrtgv5Yu2ms1NfcJwcNMkVwIy2ICBrz3u1VfmCuvz5eEUKMUuxhjBhv67cfmEIQZtewVejP3tkW8rvvUpjq7xTmAjtPSYzYkZtwzEYukRm9GVl7kvnzrIwkGSY8Cv(LysO0K3YkZxszLjPQDitPjVLvMoLNSDbFU8RpgJHJ(OuSwPlZYLFq7bJsWuBEUeKbHr0fIq3jB0fMF9XymgJXGrjyQnpxcYGWi6crO7Kn4myucMAZZLGmimIUqe6ozd(0GrjyQnpxIAZAhjr1625JOsim6cRweD9XymgJXqQ0rPoqYsUsvBiPGLzdjDYnEJidt4ykkz11hJXymgdh9Hp0Jy6DTMYD1UMJrjyQnpxIAZAhjbL315hbXiMExRXvjfoZZlNw8lXKWeAfFWOem1MNlrTzTJKGY768JUW8dH1uc)qlfBKcdn9wMedLmrewtBTIompVORpgJXymgPajlniPecZ3Lsm1yTn4mIP31Lsm1yTLJrjyQnpxIAZAhjbL315xFmgJXymsbswAqsjeMVJ1yPUyWzetVRJ1yPUihJsWuBEUe1M1osckVRZhD9XymgJXGrjyQnpxcYGWiCE6bcskHW8TsxMn4mkfRv6YSC5JU(6JXymgJHuPd(3QwpC0hXGnQXGRjlgbkXOzIiSE9XymgJXWrFqsjeMVlLyQXABm)XzWOem1MNlbzqyeop9arIvBLmrewpcIbjLqy(owJL6IbThmkbtT55sqgegHZtpqKy1owJL6Irxy(bJsWuBEUecRADoskHW8DPetnwBXhKucH57ynwQlYhDyEERpgJXymgsLouyqydfYsP66JXymgJHJ(GKsimFhRXsDXG2dvdMN3GKsimFhRXsDXy(JZGrjyQnpxcYGWiCE6bImM8ynwQlgmpVHp0Jy6DTgxLu4mpVCAu8lXKWeAuXhmkbtT55suBw7ijO8Uo)G55nyucMAZZLGmimcNNEGGKsimFR0LzdApyucMAZZLGmimcNNEGiXQn)B0fwTy0fMF9XymgJXymgdPshXKF8yTn6cBeRXsDXiwxTdcjwFmgJXymgJXGrjyQnpxck(XJ1wSgl1fX6QDqiroskHW8DSgl1f5JU(ymgJXymgJHuPdfgY4hvBJUWgMC(zKTXBOrZLsdLUmB9XymgJXymgdgLGP28CjidcJODzMGOexkn4myucMAZZLGKLiPsS2YPkF01hJXymgJXymsbswAuIlLu6YmHcdPGi66JXymgJXymgo6dgLGP28CjidcJODzMGOexknO9GrjyQnpxIAZAhjrxiSAriXJOexkfPGiJLgDH5hL4sjLUmtOWqkigCgmkbtT55suBw7ijidPGGOexkfPGiJLIU(ymgJXymgJHLQMJ(GrjyQnpxcYGWiAxMjikXLsdApyucMAZZLO2S2rs0fcRwes8ikXLss6e1E0fMFuIlLu6YmHcdPGyWzWOem1MNlrTzTJKGmKccIsCPKKorTJU(ymgJXymgJHLQ2OexkP0LzcfgsbXGZGrjyQnpxIAZAhjbzifeeL4sPYgzWZl6W88wFmgJXymgJXifizPrjUusPlZedodgLGP28CjAxMjzqKX6CmkbtT55sqgegr7YmbrjUukF01hJXymgJXymKkDOWcJSKHJ(igSbtydNFOPCJKQTHIPGvTrqm8HE0HrLX1gkmKXpQM1UGFO0LzRpgJXymgJXy4OpiPecZ3XASuxmO9GrjyQnpxcYGWiCE6bImM8ynwQlgk(GrjyQnpxIAZAhjr1625JOsyYnsQ20qAPs1Olm)6JXymgJXymgJXyiv6qHHm(r12OlSHjNFgzB8gkDz2igkm)W1JyWLsdfzdNFOPCJKQTHIPGvT1hJXymgJXymgJXGrjyQnpxcYGWiAxMjim5gjvBdodgLGP28CjizjsQeRTCmkbtT55suBw7ijQw3oFevctUrs1w(ORpgJXymgJXymgJrkqYsdtUrs1MsxMjuyiferxFmgJXymgJXymgdh9XGrjyQnpxcYGWiAxMjim5gjvBdApyucMAZZLO2S2rs0fcRwes8im5gjvBrkiYyPrxy(Hj3iPAtPlZekmKcIbNbJsWuBEUe1M1oscYqkiim5gjvBrkiYyPORpgJXymgJXymgJHLQMJ(GrjyQnpxcYGWiAxMjim5gjvBdApyucMAZZLO2S2rs0fcRwes8im5gjvBs6e1E0fMFyYnsQ2u6YmHcdPGyWzWOem1MNlrTzTJKGmKccctUrs1MKorTJU(ymgJXymgJXymgwQAdtUrs1MsxMjuyifedodgLGP28CjQnRDKeKHuqqyYnsQ2kBKbpVOdZZB9XymgJXymgJXymsbswAyYnsQ2u6YmXGZGrjyQnpxI2LzsgezSohJsWuBEUeKbHr0UmtqyYnsQ2YhD9XymgJXymgJXymyucMAZZLGmimIeR28V1uc)GZO2cNpcc6brgRZPLsxMPmOnNnOPb)rkPK8TY3k)jkv8kDzMYGMYnsQ2g00G)iLus(w5BL)eAfFuIlLu6YmHcdPGi(OexkP0LzI4dtUrs1MsxMjuyifeXhMCJKQnLUmtKp66JXymgJXymgwQARpgJXymgJXymgJbJsWuBEUeKbHrKy1M)TMs4hCg1w48rqqpiYyDoTu6YmLbT5Sbnn4psjLKVv(w5prPIxPlZug0uUrs12GMg8hPKsY3QM081uHXuPM8NqR4JsCPKsxMjuyifeXhL4sjLUmteFWOem1MNlrTzTJKGmKccctUrs1MIPGvT8rxFmgJXymgJXW88wFmgJXymSu1wFmgJXymgJXGrjyQnpxcYGWisSAZ)wtj8dodTuSrkm0yp9GiJ1UGVsBTIU(ymgJXyyEERpgJH55T(6JXyiSMs4hmkbtT55sqgegrIvB(3AkHp66MNNSYu(w4IictitPSYuExlRCZeryTSwwzHfHl4vkb)mzLBtElRmjvTdzkn5Dm5hpwBYkBCnFlRSZ7A1KHm(LS24jls0swzgz7c(QmLYk78UwMszL5futsv7qMmAEYktsv7qMSYsLkDDPshXSAIrKHjCmfLS6ihFwGAuW4AJom0qHLcmEdg92eJSaphDhjRDbFn)6sLkDDgLGP28CjQnRDKdodnqbJUoJsWuBEUe1M1osckVRhCgA1mrewRv0HuPdfdvp0IEGKQQ1WrFirGAedmFp6WOfmYsgseOed6bsQ6W5RTX4rSoJsWuBEUe1M1osIQ1TZhrDWzObRpgJHWOlSAXGZqfbTIpKkDW)gDHvlgTlZg5QgzWZRMFqtJmNNJkcAfFKXKZr7Xh8m6mQup4murO94dM1fsuhCgQiO16JXyyYnsQ2gCg8bneFiv6qt5gjvBd(zcsZ3SiSbnnYCEo0q8rgtoNilneFWZOZOs9GZGpOH4dM1fsuhCg8bnS(ymgfUAhesO0LzdodAPk(qQ0rSUAhesmAxMnYvnYGNxn)GMgzophAi(iJjNdT0UQ4dEgDgvQhCgAxv8bZ6cjQdodArdRpgJrHR2bHekmq57bNbTuPAiv6qJWKpkC1oiKyqgO89GMgzophTRk(iJjNdnOsv8bpJoJk1dodAPDvXhmRlKOo4mOfnOA9XymuWORZOem1MNlrTzTJKGmKcIbNHgmKkDOWqkigDyqvTrmuy(bbbX6JXyuIlLIuqKXsdodTKusjLusj1k(qQ0HsxMnsg9EqpigkDzMYG2C2Wvh0E0fcRwes8ikXLsrkiYyjI1hJXOexkjPtu7bNHwQurZuPnn1k(qQ0HsxMnsg9EqpigkDzMYG2C2Wvh0E0fcRwes8ikXLss6e1My9XymkXLsLnYGN3GZqljLKMPnv0CAfFiv6qPlZgjJEpOhedLUmtzqBoB4Qdf7OlewTiK4ruIlLK0jQnX6JXyyYnsQ2IuqKXsdodTKusjLusj1k(qQ0HsxMnsg9EqpigkDzMYGMYnsQ2gU6G2JUqy1IqIhHj3iPAlsbrglrS(ymgMCJKQnjDIAp4m0sLkAMkTPPwXhsLou6YSrYO3d6bXqPlZug0uUrs12Wvh0E0fcRwes8im5gjvBs6e1My9Xymm5gjvBLnYGN3GZqljLKMPnv0CAfFiv6qPlZgjJEpOhedLUmtzqt5gjvBdxDOyhDHWQfHepctUrs1MKorTjwFmgdtUrs1MIPGvTbNHwskPkvQuP1qQ0bFwGsJsydNF0f2WKBKuTnemFe2ixb)gk2r1625JOsyYnsQ2YtS(ymgky01zucMAZZLO2S2rs0fcRwes8gCgAWqQ0HsxMnsg9EOiHXkHFbNVh0dIbbbX6JXyuIlLIuqKXsdoJsRk(qQ0HsxMPmOnNn6WO2mrpOQoFedYqkiikXLss6e1My9XymkXLss6e1EWzWhQIpKkDO0LzkdAZzJomQnt0dQQZhXGmKccIsCPuzJm45rS(ymgMCJKQTifezS0GZO0QIpKkDO0LzkdAk3iPAB0HrTzIEqvD(igKHuqqyYnsQ2K0jQnX6JXyyYnsQ2K0jQ9GZGpufFiv6qPlZug0uUrs12OdJAZe9GQ68rmidPGGWKBKuTv2idEEeRpgJHcgDDPsLUUuPdfge2iYWeoMIswDKtB04rKOXkhkPXXuHXMFDPsLUoJsWuBEUeKbHn4m0afm66mkbtT55sqgegHZtpm4m0G1hJXiXQTsMicRhCgAPv81hJXGKsimFR0LzdoJsXALUmlx(ORpgJrgtESgl1fdoJy6DDSgl1fAeM8CmkbtT55suBw7ijO8UoF81hJXiXQDSgl1fdodvXxFmgJeR28Vrxy1IbNHQ4RpgJrIvB(3Qwp4muT(ymgky01zucMAZZLGmimI2LzIbNHgS(ymgL4sPbNHQ4RpgJHj3iPABWzOA9XymuWORZOem1MNlbzqyefgl1fX6QDqiXGZqduWORZOem1MNlbzqyeKmYcBWzObky01zucMAZZLGmimIeR28V1uc)GZqlfBKcdn2tpiYyTl4R0wRORZOem1MNlbzqyeDHi0DYgCgQIUUuPsxxQ0HcdcBijLNSDbFDKtB04rKOXkhkPXXuHXMFDPsLUoDkpz7c(bJsWuBEUecRA9ixPetnwBXhfgl1f5xFmgdgLGP28CjidcJW5PhisSARKjIW6bNrPetnwBrxFmgdgLGP28CjidcJW5PhiYyYJ1yPUyWzetVRJ1yPUqJWKNJrjyQnpxIAZAhjbL315JU(ymgmkbtT55sqgegHZtpqKy1owJL6IbNrHXsDr01hJXGrjyQnpxcYGWiCE6bIeR28VvTEWzWOem1MNlbzqyeop9abjLqy(wPlZIU(ymgmkbtT55sqgegrHXsDrSUAhesm4m0afm66JXyWOem1MNlbzqyeKmYcBWz4DPORBEERtNYt2UGFWOem1MNlbf)4XAlwJL6IyD1oiKyKRWyPUi)6JXyKcKS0Gllrz1bNbJsWuBEUeKbHruySuxeRR2bHerxFmgJuGKLgTlZgCgmkbtT55sqgegHZtpqqsjeMVv6YSH0bJsWuBEUeKbHr480dejwT5FRAD01hJXOzkkzeoF1eDoUSeLvJpOv8Hg0Uml(OWyPUqbZhD9XymyucMAZZLGmimcsgzHn4m8Uu01hJXigkCjBKJpNllrz1bThmkbtT55suBw7ijQw3oFevIcxTdcjuyGY35hbXix7YSH0bxwIYQXiFoxwIYQrEmsRiFq7bJsWuBEUe1M1osIQ1TZhrLOWv7GqcLUml)Gxy9XymgJXOzkkzecllW1YXLLOSA(ORpgJH55T(ymgmkbtT55sqgegHZtpqKy1owJL6IbNrHXsDr01npV1Pt5jBxWpyucMAZZLGKLiPsS2g54NjinFZIWYV(ymgPajlnQgzWZRo4mufD9XymsbswAWLLOS6GZGrjyQnpxcYGWikmwQlI1v7GqIORpgJrkqYsd)GZGpNllrz1ORpgJrkqYsdw8HIgCgQIpufD9XymKkDu2LXVKnsoVXedHfHWQvxWV(ymgsLoYn0mN8vqTNFmgAMtE(r(Xi3GnYpgJCdnZjxI8J8RpgJHuPJCdnZjp)ymgJXWpg5hJCdfnYp4mYn0mNe5hJ8RpgJHuPdjdImwpc0hDHnykkW1OPrUH2LR9HgH1cN8r(HIpYn0UCAnImgzheJ8doJCdTlNwJiJr2bXi)6JXyiv6OCiX1gDyq355nydMN3qrXhvw7Q0LW5JyiXGZGn4tdfjF9XymKkDOryTWjFWeUUiZAh5OGvhkYm)WKZpMNNXBW88g1qIRXB0HrgReB0f2GEiLcXGZhXiWptWAxWpy1bDwThS6GFHA1POKT(ymgo6d)G2dAn6cZV(ymgJXy4Op8HEWOem1MNlbzqyeKmYcB0fMF9XymgJXymgJuGKLgYJpKyWzOk(qv01hJXymgJXymsbswAOPCThFOP84dnLlr8HMsm4mufFOk(qv8HQORpgJXymgJXyS(ymgJXymgJb9GyOo(GllrzdNF44hZjQ54Ysuwn)Gxy9XymgJXymgJXymKhFiXGZGYZpgzj54Ysuw(ORpgJXymgJXymgJX6JXymgJXymgJXyOPCTp4m0uU2h8PH8HIpKhD9XymgJXymgJXym0u(GZqt5d(0qE01hJXymgJXymgJXqt5sm4m0uUed(0q(qXhseD9XymgJXymgJXym0uIbNHMsm4tdjIU(ymgJXymgJH55T(ymgJXymgJX6JXymgJXymgsLo0ypxMWX89Odd6opVrgRfo5dNNRjQ26JXymgJXymgPajlnCEUmHJ57bNHMY1UI7hshAkxX1uE01hJXymgJXymwFmgJXymgJXqQ0r5qIRnOhed2G55nu06JXymgJXymgSbNroPAkFO4dnLlXqdhopxMWX8D(bFAKtt5AFO4dnLyOHdNNlt4y(oF01hJXymgJXymu0GZiNFO4dnLlXqdhopxMWX8D(H0ronLpu8HMsm0WHZZLjCmFNp66JXymgJXymgRpgJXymgJXy4OpyJ5podvdMN3qrJ5podvJUW8RpgJXymgJXymgJbJsWuBEUeKbHrqYilSbNHgWIpuKcgD9XymgJXymgdZZB9XymgJXWsvB9XymgJXymgdw8HIgCguE(XiljhJsWuBEUeKbHrqYilS8rxFmgJXymmpV1hJXW88wFmgdh9HIgZFCgQgDH5xFmgJXymKkDeZQnuKv7bDxpsoVn6WGKLiPsS2gwTDzS24nAxMn6WqymYIrZery9OWyPUy9XymgJXOAKbpV6GZih)mbP5Bwe2qXhQiurRHIpyucMAZZLGmimcNNEGiJjpwJL6IH0bl)qdhkk66JXymgJHuPJYukQfmYEqsjeMVhTlZgDyeuuZC(HwTlZgclJ58oFeAT(ymgJXyunYGNxDWzKX6cImM8CQIpQgzWZRoKoYXOem1MNlbzqyeop9abjLqy(wPlZgshmkbtT55sqgegHZtpqKy1M)TQ15ZhD9XymmpV1hJXqynLWpQgzWZRgDDZZBD6uEY2f8dgLGP28CjAxMjzqKX6rU2LzIsTrVZV(ymgPajlnsg9EWz0UmtuQn6D01hJXifizPr1idEE1bNrYO3dAZzOAW88gzSUGGEkee5YLm69GVJsRk)ymgA4GwJXi)iigQIU(ymgPajlnYCEQ2QdoJKrVh0MZO0QgmpVrgRliONcbrUCjJEp47GpkTkv5hdnCuAvJr(rqmufD9XymsbswAueOe1bNrYO3dAZzWhLwLQbZZBKX6cc6PqqKlxYO3d(oOrLwbuPk)qdh8rPvPk)iigQIU(ymgPajln4XKOo4msg9EqBodAuPvavQgmpVrgRliONcbrUCjJEp47GpOfnWhLwLkv5hA4GgvAfqLQ8JGyOk66JXyKcKS0qcJjQdoJKrVh0MZGpOfnWhLwLkvdMN3iJ1fe0tHGixYO3dnCWh0Ig4JsRsLQ8JGyOk66JXy4OpKWyI6G2dvJUW8RpgJXymgcRPe(rTfoFee0dImwNtl(YBeJ8zr(GV8gXO2I8bF5rt8LhnXxEJym2ixR4djmMOgFWJjrn(OiqjQXhzopvB14JQrg88Q5JU(ymgwQAo6dEmjQdApun6cZV(ymgJXyiSMs4h1w48rqqpiYyDoT4lVrmQTiFWxE0eF5rt8L3igJnY1k(GhtIA8rrGsuJpYCEQ2QXhvJm45vZhD9XymSu1C0hfbkrDq7HQrxy(1hJXymgdH1uc)O2cNpcc6brgRZPfF5rt8LhnXxEJym2ixR4JIaLOgFK58uTvJpQgzWZRMp66JXyyPQ5OpYCEQ2QdApun6cZV(ymgJXyiSMs4h1w48rqqpiYyDoT4lpAIV8gXOgjY1k(iZ5PARgFunYGNxnF01hJXWsvB9XymgJXqynLWpQTW5JGGEqKX6CAXxEJySCKRv8r1idEE18rxFmgdZZBDZZtwlRLvUAj6kMGZ3YkxQ1usLYk3cxeryczkLvULGFMSY1M1uvzLP8Uww5MjIWAzLPQMAkVRLrZtwzkVX18TSYmQoiRLvwcAmD6vRLfjPANgPsw5yWXRlKjPcqZOz0iAeTIS0G2PLkAenOakGkz0LQa0GSYYPX0PxTwwK0onqdYk7PYukCreHjQYIeTKv2Xtwzn60CQP5SUqIQALUmtzqBotw5cZfrrltsAKkvLwbuPsbOzQISkaTkDKT0YOlvbISYkNcmEYukRmv1u7nUMqMIKvUzjZ3YukRCgvQDYukRL1YkZZrNUJKk1sitPSYzuP2jtPSwwlRSGrAYukRCgvQDYukRL1YktNr2UGxMszLZOsTtMszTSwwzrizYukRCgvQDYukRL1YAzTSYvzL1obTiurqlAMSYCLfjAPaANwYAzYa


--[[
Author : Aethys
Version : 1.1 (11.22.2015)
Credits : Broker_TimeToExecute for the computation.
Readme :
    WeakAura that display the TimeToExecute and TimeToDie. You can customize settings in the init section.
]]--


--- Actions\On Init\Custom ---

-- Init
---
-- User Variables (You have to /reload after modifications)
---
aura_env.static = {};
aura_env.static.unit = "target"; -- Put "focus" if you want to track your focus instead.
aura_env.static.settings = {
	execute = 35, -- Execute percentage : min=5, max=95, default = 35, aethys = 35
    refresh = 0.1, -- Refresh time (seconds) : min=0.1, max=2, default = 0.2, aethys = 0.1
    historyTime = 10, -- History time (seconds) : min=5, max=120, default = 20, aethys = 15
    historyCount = 100 -- Max history count : min=20, max=500, default = 120, aethys = 150
    };
aura_env.static.color = { -- Color to use when ...
    killNormal = "FFFFFF", -- Time left for TimeToDie is > threshold.killNormal.
    killFirst = "0070DE", -- Time left for TimeToDie is > threshold.killFirst.
    killSecond = "FF7D0A", -- Time left for TimeToDie is < threshold.killFirst.
    executeNormal = "FFFFFF", -- Time left for TimeToExecute is > threshold.executeNormal.
    executeFirst = "0070DE", -- Time left for TimeToExecute is > threshold.executeFirst.
    executeSecond = "FF7D0A", -- Time left for TimeToExecute is < threshold.executeFirst.
    executePhase = "FF0000" -- You're in the execute range (hp < settings.execute).
    };
aura_env.static.threshold = { -- Time left breakpoint for ...
    killNormal = 60, -- TimeToDie to start using color.killFirst.
    killFirst = 30, -- TimeToDie to start using color.killSecond.
    executeNormal = 60, -- TimeToExecute to start using color.executeFirst.
    executeFirst = 30, -- TimeToExecute to start using color.executeSecond.
    };
---
-- Core Variables (DO NOT TOUCH)
---
aura_env.core = {};
aura_env.core.info = {
    lastTarget = "",
    currentTime = GetTime();
    maxHealth = UnitHealthMax(aura_env.static.unit),
    lastHealth = 0,
    lastRefresh = 0,
    lastReset = 0
    };
aura_env.core.timer = {
    kill = 0,
    execute = 0
    };
aura_env.core.healthHistory = {};
aura_env.core.cache = {};
aura_env.core.lastReturn = "<No Informations>";
aura_env.core.throttle = 0;
---
-- Core Functions (DO NOT TOUCH)
---
function aura_env.reset (GUID, health)
	aura_env.core.info.lastTarget = GUID;
    aura_env.core.info.maxHealth = UnitHealthMax(aura_env.static.unit);
    aura_env.core.info.lastHealth = health;
    aura_env.core.info.lastReset = aura_env.core.info.currentTime;
    aura_env.core.healthHistory = {};
    aura_env.core.cache = nil;
end
function aura_env.updateHealthHistory (health)
	local values = aura_env.core.healthHistory;
    local time = aura_env.core.info.currentTime - aura_env.core.info.lastReset;
    table.insert(values, 1, {time, health});
    aura_env.core.cache = nil;
    while (#values > aura_env.static.settings.historyCount) or (time - values[#values][1] > aura_env.static.settings.historyTime) do
        table.remove(values);
    end
    aura_env.core.info.lastHealth = health;
end
function aura_env.calculate (percentage)
	local seconds = 0;
    local values = aura_env.core.healthHistory;
    local n = #values;
    local a, b = 0, 0;
    -- Simple linear regression
    -- ( E(x^2)   E(x) )  ( a )   ( E(xy) )
    -- ( E(x)       n  )  ( b ) = ( E(y)  )
    -- Format of the above: ( 2x2 Matrix ) * ( 2x1 Vector ) = ( 2x1 Vector )
    -- Solve to find a and b, satisfying y = a + bx
    -- Matrix arithmetic has been expanded and solved to make the following operation as fast as possible
    if n > 1 then
        if not aura_env.core.cache then
            local x, y = 0, 0;
            local Ex2, Ex, Exy, Ey = 0, 0, 0, 0;
            
            for _, value in ipairs(values) do
                x, y = unpack(value);
                
                Ex2 = Ex2 + x * x;
                Ex = Ex + x;
                Exy = Exy + x * y;
                Ey = Ey + y;
            end
            
            -- Invariant to find matrix inverse
            local invariant = Ex2*n - Ex*Ex;
            
            -- Solve for a and b
            a = (-Ex * Exy / invariant) + (Ex2 * Ey / invariant);
            b = (n * Exy / invariant) - (Ex * Ey / invariant);
            
            if a ~= 0 and b ~= 0 then
                aura_env.core.cache = {a, b};
            end
        else
            a, b = unpack(aura_env.core.cache);
        end
    end
    if b ~= 0 then
        -- Use best fit line to calculate estimated time to reach target health
        seconds = (percentage * 0.01 * aura_env.core.info.maxHealth - a) / b;
        -- Subtract current time to obtain "time remaining"
        seconds = math.max(0, seconds - (aura_env.core.info.currentTime - aura_env.core.info.lastReset));
    end
    return seconds;
end
function aura_env.timeFormat (timerLeft)
	local left = timerLeft;
    local seconds = left >= 0 and math.floor((left % 60)    / 1   ) or 0;
    local minutes = left >= 60 and math.floor((left % 3600)  / 60  ) or 0;
    local hours = left >= 3600 and math.floor((left % 86400) / 3600) or 0;
    local days = left >= 86400 and math.floor((left % 31536000) / 86400) or 0;
    local years = left >= 31536000 and math.floor(left / 31536000) or 0;
    if years > 0 then
        return string.format("%d [Y] %d [D] %d:%d:%d [H]", years, days, hours, minutes, seconds);
    elseif days > 0 then
        return string.format("%d [D] %d:%d:%d [H]", days, hours, minutes, seconds);
    elseif hours > 0 then
        return string.format("%d:%d:%d [H]", hours, minutes, seconds);
    elseif minutes > 0 then
        return string.format("%d:%d [M]", minutes, seconds);
    else
        return string.format("%d [S]", seconds);
    end
end

--- Trigger\Custom Trigger ---

-- Trigger WA Status [Health -> Target/Focus]


--- Display\Custom Function ---

-- Refresh [Every Frame]
function()
    if GetTime() > aura_env.core.throttle then
    	aura_env.core.throttle = aura_env.core.throttle + aura_env.static.settings.refresh;
        -- Localize Frame Fixed Variables
        if not UnitExists(aura_env.static.unit) or UnitIsFriend("player", aura_env.static.unit) then return "<No Enemy Target>"; end;
        local currentGUID = UnitGUID(aura_env.static.unit)
        local currentHealth = UnitHealth(aura_env.static.unit);
        aura_env.core.info.currentTime = GetTime();

        -- Reset if we switch our target
        if currentGUID ~= aura_env.core.info.lastTarget or currentHealth > aura_env.core.info.lastHealth then aura_env.reset(currentGUID, currentHealth); end
        -- Core Calls
        if currentHealth > 0 and currentHealth ~= aura_env.core.info.maxHealth and not UnitIsFriend('player', aura_env.static.unit) and aura_env.core.info.currentTime > aura_env.core.info.lastRefresh then
            -- Update the Health History
            aura_env.updateHealthHistory(currentHealth);
            -- Compute the expected Kill Time
            aura_env.core.timer.kill = aura_env.calculate(0);
            local killTimerColor;
            if aura_env.core.timer.kill > aura_env.static.threshold.killNormal then killTimerColor = aura_env.static.color.killNormal;
            elseif aura_env.core.timer.kill > aura_env.static.threshold.killFirst then killTimerColor = aura_env.static.color.killFirst;
            else killTimerColor = aura_env.static.color.killSecond; end
            local killTimer = aura_env.timeFormat(aura_env.core.timer.kill);
            -- Check if we are in Execute Phase or not to save Computation Time
            if currentHealth > aura_env.core.info.maxHealth * aura_env.static.settings.execute/100 then
                -- Compute the expected Time when it will be in Execute Phase
                aura_env.core.timer.execute = aura_env.calculate(aura_env.static.settings.execute);
                local executeTimerColor;
                if  aura_env.core.timer.execute > aura_env.static.threshold.executeNormal then executeTimerColor = aura_env.static.color.executeNormal;
                elseif aura_env.core.timer.execute > aura_env.static.threshold.executeFirst then executeTimerColor = aura_env.static.color.executeFirst;
                else executeTimerColor = aura_env.static.color.executeSecond; end
                local executeTimer = aura_env.timeFormat(aura_env.core.timer.execute);
                aura_env.core.lastReturn = string.format("TimeToDie : |cFF%s%s|r\nTimeToExecute : |cFF%s%s|r", killTimerColor, killTimer, executeTimerColor, executeTimer);
            else
                aura_env.core.lastReturn = string.format("TimeToDie : |cFF%s%s|r\nTimeToExecute : |cFF%sEXECUTE|r", killTimerColor, killTimer, aura_env.static.color.executePhase);
            end
        else
            aura_env.core.lastReturn = "<No Informations>";
        end
    end

    return aura_env.core.lastReturn;
end